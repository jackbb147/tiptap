{"version":3,"file":"index.umd.js","sources":["../src/listHelpers/findListItemPos.ts","../src/listHelpers/getNextListDepth.ts","../src/listHelpers/hasListBefore.ts","../src/listHelpers/hasListItemBefore.ts","../src/listHelpers/listItemHasSubList.ts","../src/listHelpers/handleBackspace.ts","../src/listHelpers/nextListIsDeeper.ts","../src/listHelpers/nextListIsHigher.ts","../src/listHelpers/handleDelete.ts","../src/listHelpers/hasListItemAfter.ts","../src/list-keymap.ts"],"sourcesContent":["import { getNodeType } from '@tiptap/core'\nimport { NodeType } from '@tiptap/pm/model'\nimport { EditorState } from '@tiptap/pm/state'\n\nexport const findListItemPos = (typeOrName: string | NodeType, state: EditorState) => {\n  const { $from } = state.selection\n  const nodeType = getNodeType(typeOrName, state.schema)\n\n  let currentNode = null\n  let currentDepth = $from.depth\n  let currentPos = $from.pos\n  let targetDepth: number | null = null\n\n  while (currentDepth > 0 && targetDepth === null) {\n    currentNode = $from.node(currentDepth)\n\n    if (currentNode.type === nodeType) {\n      targetDepth = currentDepth\n    } else {\n      currentDepth -= 1\n      currentPos -= 1\n    }\n  }\n\n  if (targetDepth === null) {\n    return null\n  }\n\n  return { $pos: state.doc.resolve(currentPos), depth: targetDepth }\n}\n","import { getNodeAtPosition } from '@tiptap/core'\nimport { EditorState } from '@tiptap/pm/state'\n\nimport { findListItemPos } from './findListItemPos.js'\n\nexport const getNextListDepth = (typeOrName: string, state: EditorState) => {\n  const listItemPos = findListItemPos(typeOrName, state)\n\n  if (!listItemPos) {\n    return false\n  }\n\n  const [, depth] = getNodeAtPosition(state, typeOrName, listItemPos.$pos.pos + 4)\n\n  return depth\n}\n","import { EditorState } from '@tiptap/pm/state'\n\nexport const hasListBefore = (editorState: EditorState, name: string, parentListTypes: string[]) => {\n  const { $anchor } = editorState.selection\n\n  const previousNodePos = Math.max(0, $anchor.pos - 2)\n\n  const previousNode = editorState.doc.resolve(previousNodePos).node()\n\n  if (!previousNode || !parentListTypes.includes(previousNode.type.name)) {\n    return false\n  }\n\n  return true\n}\n","import { EditorState } from '@tiptap/pm/state'\n\nexport const hasListItemBefore = (typeOrName: string, state: EditorState): boolean => {\n  const { $anchor } = state.selection\n\n  const $targetPos = state.doc.resolve($anchor.pos - 2)\n\n  if ($targetPos.index() === 0) {\n    return false\n  }\n\n  if ($targetPos.nodeBefore?.type.name !== typeOrName) {\n    return false\n  }\n\n  return true\n}\n","import { getNodeType } from '@tiptap/core'\nimport { Node } from '@tiptap/pm/model'\nimport { EditorState } from '@tiptap/pm/state'\n\nexport const listItemHasSubList = (typeOrName: string, state: EditorState, node?: Node) => {\n  if (!node) {\n    return false\n  }\n\n  const nodeType = getNodeType(typeOrName, state.schema)\n\n  let hasSubList = false\n\n  node.descendants(child => {\n    if (child.type === nodeType) {\n      hasSubList = true\n    }\n  })\n\n  return hasSubList\n}\n","import { Editor, isAtStartOfNode, isNodeActive } from '@tiptap/core'\nimport { Node } from '@tiptap/pm/model'\n\nimport { findListItemPos } from './findListItemPos.js'\nimport { hasListBefore } from './hasListBefore.js'\nimport { hasListItemBefore } from './hasListItemBefore.js'\nimport { listItemHasSubList } from './listItemHasSubList.js'\n\nexport const handleBackspace = (editor: Editor, name: string, parentListTypes: string[]) => {\n  // this is required to still handle the undo handling\n  if (editor.commands.undoInputRule()) {\n    return true\n  }\n\n  // if the current item is NOT inside a list item &\n  // the previous item is a list (orderedList or bulletList)\n  // move the cursor into the list and delete the current item\n  if (!isNodeActive(editor.state, name) && hasListBefore(editor.state, name, parentListTypes)) {\n    const { $anchor } = editor.state.selection\n\n    const $listPos = editor.state.doc.resolve($anchor.before() - 1)\n\n    const listDescendants: Array<{ node: Node, pos: number }> = []\n\n    $listPos.node().descendants((node, pos) => {\n      if (node.type.name === name) {\n        listDescendants.push({ node, pos })\n      }\n    })\n\n    const lastItem = listDescendants.at(-1)\n\n    if (!lastItem) {\n      return false\n    }\n\n    const $lastItemPos = editor.state.doc.resolve($listPos.start() + lastItem.pos + 1)\n\n    return editor.chain().cut({ from: $anchor.start() - 1, to: $anchor.end() + 1 }, $lastItemPos.end()).joinForward().run()\n  }\n\n  // if the cursor is not inside the current node type\n  // do nothing and proceed\n  if (!isNodeActive(editor.state, name)) {\n    return false\n  }\n\n  // if the cursor is not at the start of a node\n  // do nothing and proceed\n  if (!isAtStartOfNode(editor.state)) {\n    return false\n  }\n\n  const listItemPos = findListItemPos(name, editor.state)\n\n  if (!listItemPos) {\n    return false\n  }\n\n  const $prev = editor.state.doc.resolve(listItemPos.$pos.pos - 2)\n  const prevNode = $prev.node(listItemPos.depth)\n\n  const previousListItemHasSubList = listItemHasSubList(name, editor.state, prevNode)\n\n  // if the previous item is a list item and doesn't have a sublist, join the list items\n  if (hasListItemBefore(name, editor.state) && !previousListItemHasSubList) {\n    return editor.commands.joinItemBackward()\n  }\n\n  // otherwise in the end, a backspace should\n  // always just lift the list item if\n  // joining / merging is not possible\n  return editor.chain().liftListItem(name).run()\n}\n","import { EditorState } from '@tiptap/pm/state'\n\nimport { findListItemPos } from './findListItemPos.js'\nimport { getNextListDepth } from './getNextListDepth.js'\n\nexport const nextListIsDeeper = (typeOrName: string, state: EditorState) => {\n  const listDepth = getNextListDepth(typeOrName, state)\n  const listItemPos = findListItemPos(typeOrName, state)\n\n  if (!listItemPos || !listDepth) {\n    return false\n  }\n\n  if (listDepth > listItemPos.depth) {\n    return true\n  }\n\n  return false\n}\n","import { EditorState } from '@tiptap/pm/state'\n\nimport { findListItemPos } from './findListItemPos.js'\nimport { getNextListDepth } from './getNextListDepth.js'\n\nexport const nextListIsHigher = (typeOrName: string, state: EditorState) => {\n  const listDepth = getNextListDepth(typeOrName, state)\n  const listItemPos = findListItemPos(typeOrName, state)\n\n  if (!listItemPos || !listDepth) {\n    return false\n  }\n\n  if (listDepth < listItemPos.depth) {\n    return true\n  }\n\n  return false\n}\n","import { Editor, isAtEndOfNode, isNodeActive } from '@tiptap/core'\n\nimport { nextListIsDeeper } from './nextListIsDeeper.js'\nimport { nextListIsHigher } from './nextListIsHigher.js'\n\nexport const handleDelete = (editor: Editor, name: string) => {\n  // if the cursor is not inside the current node type\n  // do nothing and proceed\n  if (!isNodeActive(editor.state, name)) {\n    return false\n  }\n\n  // if the cursor is not at the end of a node\n  // do nothing and proceed\n  if (!isAtEndOfNode(editor.state, name)) {\n    return false\n  }\n\n  // check if the next node is a list with a deeper depth\n  if (nextListIsDeeper(name, editor.state)) {\n    return editor\n      .chain()\n      .focus(editor.state.selection.from + 4)\n      .lift(name)\n      .joinBackward()\n      .run()\n  }\n\n  if (nextListIsHigher(name, editor.state)) {\n    return editor.chain()\n      .joinForward()\n      .joinBackward()\n      .run()\n  }\n\n  return editor.commands.joinItemForward()\n}\n","import { EditorState } from '@tiptap/pm/state'\n\nexport const hasListItemAfter = (typeOrName: string, state: EditorState): boolean => {\n  const { $anchor } = state.selection\n\n  const $targetPos = state.doc.resolve($anchor.pos - $anchor.parentOffset - 2)\n\n  if ($targetPos.index() === $targetPos.parent.childCount - 1) {\n    return false\n  }\n\n  if ($targetPos.nodeAfter?.type.name !== typeOrName) {\n    return false\n  }\n\n  return true\n}\n","import { Extension } from '@tiptap/core'\n\nimport { handleBackspace, handleDelete } from './listHelpers/index.js'\n\nexport type ListKeymapOptions = {\n  listTypes: Array<{\n    itemName: string,\n    wrapperNames: string[],\n  }>\n}\n\nexport const ListKeymap = Extension.create<ListKeymapOptions>({\n  name: 'listKeymap',\n\n  addOptions() {\n    return {\n      listTypes: [\n        {\n          itemName: 'listItem',\n          wrapperNames: ['bulletList', 'orderedList'],\n        },\n        {\n          itemName: 'taskItem',\n          wrapperNames: ['taskList'],\n        },\n      ],\n    }\n  },\n\n  addKeyboardShortcuts() {\n    return {\n      Delete: ({ editor }) => {\n        let handled = false\n\n        this.options.listTypes.forEach(({ itemName }) => {\n          if (editor.state.schema.nodes[itemName] === undefined) {\n            return\n          }\n\n          if (handleDelete(editor, itemName)) {\n            handled = true\n          }\n        })\n\n        return handled\n      },\n      'Mod-Delete': ({ editor }) => {\n        let handled = false\n\n        this.options.listTypes.forEach(({ itemName }) => {\n          if (editor.state.schema.nodes[itemName] === undefined) {\n            return\n          }\n\n          if (handleDelete(editor, itemName)) {\n            handled = true\n          }\n        })\n\n        return handled\n      },\n      Backspace: ({ editor }) => {\n        let handled = false\n\n        this.options.listTypes.forEach(({ itemName, wrapperNames }) => {\n          if (editor.state.schema.nodes[itemName] === undefined) {\n            return\n          }\n\n          if (handleBackspace(editor, itemName, wrapperNames)) {\n            handled = true\n          }\n        })\n\n        return handled\n      },\n      'Mod-Backspace': ({ editor }) => {\n        let handled = false\n\n        this.options.listTypes.forEach(({ itemName, wrapperNames }) => {\n          if (editor.state.schema.nodes[itemName] === undefined) {\n            return\n          }\n\n          if (handleBackspace(editor, itemName, wrapperNames)) {\n            handled = true\n          }\n        })\n\n        return handled\n      },\n    }\n  },\n})\n"],"names":["getNodeType","getNodeAtPosition","isNodeActive","isAtStartOfNode","isAtEndOfNode","Extension"],"mappings":"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"}